<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Dla Agaty ‚ú®</title>

<style>
:root{
  --bg1:#050505;
  --bg2:#0b0b0b;
  --gold:#d4af37;
  --gold2:#f2d36b;
  --card: rgba(255, 255, 255, 0.06);
  --text: rgba(255,255,255,0.92);
}
*{ box-sizing:border-box; }

body{
  margin:0; min-height:100vh;
  display:flex; justify-content:center; align-items:center;
  overflow:hidden;
  font-family: "Segoe UI", system-ui, Arial, sans-serif;
  color: var(--text);
  background:
    radial-gradient(1200px 700px at 15% 10%, rgba(212,175,55,0.12), transparent 55%),
    radial-gradient(900px 600px at 85% 20%, rgba(242,211,107,0.10), transparent 50%),
    linear-gradient(135deg, var(--bg1), var(--bg2));
  position: relative;
}

#dim{
  position: fixed; inset: 0;
  opacity: 0;
  transition: opacity 220ms ease;
  pointer-events: none;
  z-index: 0;
}
#dim.on{ opacity: 1; background: rgba(0,0,0,0.28); }

.card{
  width: min(560px, 92vw);
  max-height: 90vh;
  overflow:auto;
  padding: 34px 28px;
  border-radius: 26px;
  background: linear-gradient(180deg, var(--card), rgba(255,255,255,0.04));
  border: 1px solid rgba(212,175,55,0.28);
  box-shadow: 0 20px 50px rgba(0,0,0,0.55);
  backdrop-filter: blur(12px);
  position: relative;
  z-index: 2;
}

.scene{ transition: opacity 520ms ease, transform 520ms ease, filter 520ms ease; }
.scene.out{ opacity: 0; transform: translateY(-6px); filter: blur(1px); pointer-events:none; }
.scene.in{ opacity: 0; transform: translateY(10px); filter: blur(1px); }
.scene.in.show{ opacity: 1; transform: translateY(0); filter: blur(0); }

h1{ margin: 0 0 10px 0; font-weight: 550; font-size: 34px; color: var(--gold2); }
.sub{ font-size:18px; line-height:1.7; color: rgba(255,255,255,0.82); }
h2{ margin-top:20px; font-weight:600; }

.buttons{ margin-top: 26px; display:flex; justify-content:center; gap: 18px; flex-wrap: wrap; }

.btn{
  font-size: 18px;
  padding: 12px 22px;
  border-radius: 999px;
  cursor: pointer;
  border: 1px solid rgba(212,175,55,0.45);
  transition: transform 220ms ease, box-shadow 220ms ease, filter 220ms ease, opacity 220ms ease;
  user-select:none;
}

.btnRow{ display:flex; gap: 12px; flex-wrap: wrap; margin-top: 14px; }
.btnWide{ width: 100%; justify-content: center; display: inline-flex; align-items: center; gap: 10px; }

#yes{
  background: linear-gradient(135deg, rgba(212,175,55,0.95), rgba(242,211,107,0.85));
  color: #0b0b0b;
  box-shadow: 0 10px 24px rgba(212,175,55,0.18);
  transform: scale(1);
}
.pulse{
  animation: pulse 1.05s ease-in-out infinite;
  box-shadow:
    0 16px 34px rgba(212,175,55,0.25),
    0 0 22px rgba(212,175,55,0.22),
    0 0 44px rgba(242,211,107,0.16);
}
@keyframes pulse{
  0%{ transform: scale(var(--s)); filter: brightness(1); }
  50%{ transform: scale(calc(var(--s) + 0.045)); filter: brightness(1.06); }
  100%{ transform: scale(var(--s)); filter: brightness(1); }
}
#no{
  background: rgba(255,255,255,0.06);
  color: rgba(255,255,255,0.92);
  border-color: rgba(255,255,255,0.18);
  position: relative;
}
.crack{ animation: crack 520ms ease forwards; transform-origin:center; }
@keyframes crack{
  0%{ transform: translate(0,0) rotate(0) scale(1); opacity: 1; }
  35%{ transform: translate(-6px, 2px) rotate(-4deg) scale(1.02); }
  55%{ transform: translate(7px, -2px) rotate(6deg) scale(0.98); }
  100%{ transform: translate(0, 30px) rotate(18deg) scale(0.65); opacity: 0; }
}

#sparksLayer{ position: fixed; inset: 0; pointer-events:none; z-index: 1; }
.spark{
  position:absolute; width:5px; height:5px; border-radius:999px;
  background: rgba(212,175,55,0.95);
  box-shadow: 0 0 10px rgba(212,175,55,0.35);
  opacity:0; animation: spark 520ms ease-out forwards;
}
@keyframes spark{
  0%{ opacity:0; transform: translate(0,0) scale(0.9); }
  15%{ opacity:1; }
  100%{ opacity:0; transform: translate(var(--dx), var(--dy)) scale(0.7); }
}

#heartsLayer{ position: fixed; inset: 0; pointer-events:none; display:none; z-index: 1; }
.goldHeart{
  position:absolute; bottom:-40px; font-size:18px;
  color: rgba(212,175,55,0.85);
  text-shadow: 0 0 14px rgba(212,175,55,0.22);
  animation: floatUp linear forwards;
}
@keyframes floatUp{
  0%{ transform: translateY(0) translateX(0); opacity:0; }
  10%{ opacity:0.9; }
  100%{ transform: translateY(-110vh) translateX(var(--drift)); opacity:0; }
}

/* Napisy w tle (Akt 1) */
#loveTextLayer{ position: fixed; inset:0; pointer-events:none; z-index:0; overflow:hidden; }
.loveText{
  position:absolute; left:-25vw;
  padding:10px 14px; border-radius:999px;
  font-size:18px;
  color: rgba(242,211,107,0.55);
  border: 1px solid rgba(212,175,55,0.18);
  background: rgba(0,0,0,0.12);
  backdrop-filter: blur(6px);
  opacity:0;
  filter: blur(0.6px);
  text-shadow: 0 0 16px rgba(212,175,55,0.10);
  animation: driftText linear forwards;
}
@keyframes driftText{
  0%{ transform: translateX(-18vw) translateY(0); opacity:0; }
  12%{ opacity:0.9; }
  85%{ opacity:0.75; }
  100%{ transform: translateX(140vw) translateY(var(--dy)); opacity:0; }
}

#finalTitle{ font-size:28px; color: var(--gold2); margin-top:0; }
.meta{ margin: 6px 0 14px; opacity:0.8; }
.mysteryBox{
  margin:10px 0 16px; padding:16px;
  border-radius:16px;
  background: rgba(212,175,55,0.06);
  border: 1px solid rgba(212,175,55,0.18);
  line-height:1.75; color: rgba(255,255,255,0.86);
}
.smallHint{
  margin-top:12px; padding-top:10px;
  border-top: 1px dashed rgba(242,211,107,0.18);
  opacity:0.92;
}

#final img{
  width:100%; max-height:52vh; object-fit:contain;
  border-radius:18px;
  border:1px solid rgba(212,175,55,0.22);
  box-shadow: 0 18px 40px rgba(0,0,0,0.55);
}

/* kontrolka muzyki */
.musicCtrl{ margin-top:12px; display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
.musicBtn{
  display:inline-flex; align-items:center; gap:10px;
  border-radius:999px; padding:10px 14px;
  cursor:pointer;
  border:1px solid rgba(212,175,55,0.28);
  background: rgba(255,255,255,0.05);
  color: rgba(255,255,255,0.92);
}
.musicDot{
  width:8px; height:8px; border-radius:999px;
  background: rgba(242,211,107,0.55);
  box-shadow: 0 0 14px rgba(212,175,55,0.25);
}
.musicDot.on{ background: rgba(242,211,107,0.95); }
.musicMsg{
  width:100%;
  margin-top:8px;
  font-size: 13px;
  opacity: .86;
  color: rgba(242,211,107,0.85);
  background: rgba(212,175,55,0.06);
  border: 1px solid rgba(212,175,55,0.18);
  padding: 10px 12px;
  border-radius: 14px;
  display:none;
}
.musicMsg.show{ display:block; }

/* modal kr√≥wki */
#cowModal{ position:fixed; inset:0; display:none; align-items:center; justify-content:center; z-index:999; }
#cowModal.on{ display:flex; }
.cowBackdrop{ position:absolute; inset:0; background: rgba(0,0,0,0.62); backdrop-filter: blur(6px); }
.cowCard{
  position:relative;
  width:min(520px, 92vw);
  border-radius:22px;
  background: rgba(15,15,15,0.92);
  border: 1px solid rgba(212,175,55,0.28);
  box-shadow: 0 30px 80px rgba(0,0,0,0.7);
  padding:14px;
}
.cowTop{ display:flex; align-items:center; justify-content:space-between; gap:10px; padding: 6px 6px 10px; }
.cowTop .t{ color: rgba(242,211,107,0.95); font-weight:900; }
.cowClose{
  cursor:pointer;
  border: 1px solid rgba(212,175,55,0.30);
  background: rgba(255,255,255,0.06);
  color: rgba(255,255,255,0.9);
  border-radius: 999px;
  padding: 8px 12px;
}
.cowImg{ width:100%; max-height:64vh; object-fit:contain; border-radius:18px; border:1px solid rgba(212,175,55,0.18); }
</style>
</head>

<body>
<div id="loveTextLayer" aria-hidden="true"></div>
<div id="dim"></div>
<div id="heartsLayer"></div>
<div id="sparksLayer"></div>

<!-- ‚úÖ audio: pr√≥bujemy MP3, ale dodajemy te≈º M4A je≈õli oka≈ºe siƒô potrzebne -->
<audio id="bgm" preload="auto" loop playsinline>
  <source src="music.mp3" type="audio/mpeg">
  <source src="music.mp3" type="audio/mp4"> <!-- gdyby to by≈Ço m4a "w ≈õrodku" -->
</audio>

<div id="cowModal" aria-hidden="true">
  <div class="cowBackdrop"></div>
  <div class="cowCard" role="dialog" aria-modal="true" aria-label="Ukryta wiadomo≈õƒá">
    <div class="cowTop">
      <div class="t">üêÆ Tajna kr√≥wka d≈Çugow≈Çosa ‚ú®</div>
      <button class="cowClose" id="cowCloseBtn" type="button">Zamknij</button>
    </div>
    <img class="cowImg" src="krowka.jpg" alt="Kr√≥wka d≈Çugow≈Çosa">
  </div>
</div>

<div class="card">

  <div id="intro" class="scene">
    <h1 id="titleAgata">Dla Agaty ‚ú®</h1>

    <p class="sub">
      Twoje obawy by≈Çy s≈Çuszne. Mia≈Ça≈õ racjƒô‚Ä¶<br>
      Nie patrzƒô ju≈º na Ciebie tak jak kiedy≈õ.<br><br>
      Patrzƒô na Ciebie mocniej. Pewniej. Z wiƒôkszym uczuciem.<br>
      OdkƒÖd zapad≈Ça decyzja, ≈ºe to nie koniec ‚Äî w moich oczach jeste≈õ jeszcze bardziej ‚ÄûTy‚Äù.<br><br>
      Kocham Ciƒô.<br>
      I dlatego chcƒô Ciƒô zapytaƒá o jedno‚Ä¶
    </p>

    <h2>Czy <span style="color: rgba(242,211,107,0.95);">Agol</span> zostanie MojƒÖ WalentynkƒÖ? üíò</h2>

    <div class="buttons">
      <button id="yes" class="btn" type="button">TAK üíõ</button>
      <button id="no" class="btn" type="button">NIE üôà</button>
    </div>
  </div>

  <div id="final" class="scene in" style="display:none;">
    <h2 id="finalTitle">Wiedzia≈Çem‚Ä¶ üíï</h2>
    <div class="meta">14.02.2026</div>

    <div class="mysteryBox">
      <strong>Zaproszenie</strong> do prywatnej domowej sali kinowej pe≈Çnej magicznego klimatu‚Ä¶ ‚ú®<br><br>
      Tego dnia przewidujƒô czas na ma≈Çy podarunek üéÅ, romantyczny seans üé¨, posi≈Çek üçΩÔ∏è,
      wino üç∑ (nie pamiƒôtam czy lubisz, wiƒôc spokojnie mo≈ºemy to ustaliƒá),
      oraz Mszƒô za cudownego cz≈Çowieka ‚õ™üíõ
      <div class="smallHint">
        Czy mam wiƒôcej kart w zanadrzu? üòè<br>
        <strong>Nie mogƒô wiƒôcej zdradziƒá.</strong>
      </div>
    </div>

    <p class="sub">To jeden z tych moment√≥w, do kt√≥rych chcƒô wracaƒá‚Ä¶ üíû</p>
    <img src="photo.jpg" alt="Nasze zdjƒôcie">

    <!-- ‚úÖ muzyka -->
    <div class="musicCtrl">
      <button id="musicToggle" class="musicBtn" type="button">
        <span id="musicDot" class="musicDot"></span>
        <span id="musicLabel">Muzyka: OFF</span>
      </button>
      <div id="musicMsg" class="musicMsg"></div>
    </div>

  </div>
</div>

<script>
/* ---------- szybki debug na ekranie ---------- */
function showMusicMsg(text){
  const el = document.getElementById("musicMsg");
  if(!el) return;
  el.textContent = text;
  el.classList.add("show");
}
function clearMusicMsg(){
  const el = document.getElementById("musicMsg");
  if(!el) return;
  el.textContent = "";
  el.classList.remove("show");
}

/* ---------- audio ---------- */
const bgm = document.getElementById("bgm");
const musicToggle = document.getElementById("musicToggle");
const musicDot = document.getElementById("musicDot");
const musicLabel = document.getElementById("musicLabel");

let musicOn = false;
let fadeRAF = null;

function setMusicUI(on){
  musicOn = on;
  musicDot.classList.toggle("on", on);
  musicLabel.textContent = on ? "Muzyka: ON" : "Muzyka: OFF";
}

function fadeTo(target, ms=700){
  if(fadeRAF) cancelAnimationFrame(fadeRAF);
  const start = bgm.volume;
  const t0 = performance.now();
  function step(now){
    const p = Math.min(1, (now - t0) / ms);
    bgm.volume = start + (target - start) * p;
    if(p < 1) fadeRAF = requestAnimationFrame(step);
  }
  fadeRAF = requestAnimationFrame(step);
}

async function startMusic(){
  clearMusicMsg();
  bgm.volume = 0.02;

  try{
    await bgm.play();
    setMusicUI(true);
    fadeTo(0.18, 900);
    showMusicMsg("Muzyka gra ‚úÖ (je≈õli jest za g≈Ço≈õno, zmniejszƒô w kodzie)");
  }catch(err){
    setMusicUI(false);
    showMusicMsg("Nie mogƒô odtworzyƒá. Najczƒô≈õciej plik to m4a nazwany .mp3 albo przeglƒÖdarka nie mo≈ºe go zdekodowaƒá.");
    console.error("PLAY ERROR:", err);
  }
}

function stopMusic(){
  clearMusicMsg();
  fadeTo(0.0, 550);
  setTimeout(() => bgm.pause(), 560);
  setMusicUI(false);
  showMusicMsg("Muzyka zatrzymana ‚è∏Ô∏è");
}

async function toggleMusic(){
  // ‚úÖ zawsze zmieniamy UI od razu, ≈ºeby by≈Ço widaƒá reakcjƒô
  if(!musicOn){
    setMusicUI(true);
    showMusicMsg("Pr√≥bujƒô uruchomiƒá‚Ä¶");
    await startMusic();
  }else{
    setMusicUI(false);
    stopMusic();
  }
}

musicToggle.addEventListener("click", toggleMusic);

bgm.addEventListener("error", () => {
  setMusicUI(false);
  showMusicMsg("B≈ÇƒÖd ≈Çadowania audio. Sprawd≈∫ czy music.mp3 faktycznie istnieje i jest MP3.");
});

/* sprawdzamy, czy plik siƒô w og√≥le ≈Çaduje (404 / cache) */
fetch("music.mp3", { cache: "no-store" })
  .then(r => {
    if(!r.ok) throw new Error("HTTP " + r.status);
    showMusicMsg("Plik music.mp3 znaleziony ‚úÖ Kliknij 'Muzyka: OFF' ≈ºeby odpaliƒá.");
  })
  .catch(e => {
    setMusicUI(false);
    showMusicMsg("Nie mogƒô pobraƒá music.mp3 (brak pliku / cache / z≈Ça ≈õcie≈ºka): " + e.message);
  });

/* ---------- reszta (minimalnie, ≈ºeby dzia≈Ça≈Ça strona) ---------- */
const yesBtn = document.getElementById("yes");
const noBtn = document.getElementById("no");
const intro = document.getElementById("intro");
const final = document.getElementById("final");
const dim = document.getElementById("dim");
const heartsLayer = document.getElementById("heartsLayer");
const sparksLayer = document.getElementById("sparksLayer");
const loveLayer = document.getElementById("loveTextLayer");

let yesScale = 1;
const maxScale = 1.38;
const pulseStartAt = 1.18;
let cracked = false;

function applyYesScale(){
  yesBtn.style.setProperty("--s", yesScale.toFixed(3));
  if(!yesBtn.classList.contains("pulse")){
    yesBtn.style.transform = `scale(${yesScale})`;
  }
}
applyYesScale();

function spawnSparksAt(x, y){
  const count = 9;
  for(let i=0;i<count;i++){
    const s = document.createElement("div");
    s.className = "spark";
    s.style.left = x + "px";
    s.style.top  = y + "px";
    s.style.setProperty("--dx", (Math.random()*80 - 40).toFixed(0) + "px");
    s.style.setProperty("--dy", (-20 - Math.random()*70).toFixed(0) + "px");
    s.style.animationDelay = (Math.random()*70).toFixed(0) + "ms";
    const size = (3 + Math.random()*3).toFixed(0) + "px";
    s.style.width = size;
    s.style.height = size;
    sparksLayer.appendChild(s);
    s.addEventListener("animationend", () => s.remove(), { once:true });
  }
}
function crackNo(){
  if(cracked) return;
  cracked = true;
  const r = noBtn.getBoundingClientRect();
  spawnSparksAt(r.left + r.width/2, r.top + r.height/2);
  noBtn.classList.add("crack");
  noBtn.style.pointerEvents = "none";
  noBtn.addEventListener("animationend", () => { noBtn.style.display = "none"; }, { once:true });
}
function maybeEnablePulse(){
  if(yesScale >= pulseStartAt && !yesBtn.classList.contains("pulse")){
    yesBtn.classList.add("pulse");
    crackNo();
  }
}
function dodgeNo(){
  if(noBtn.style.display !== "none"){
    const x = Math.random() * 220 - 110;
    const y = Math.random() * 120 - 60;
    noBtn.style.transform = `translate(${x}px, ${y}px)`;
  }
  yesScale = Math.min(maxScale, yesScale + 0.055);
  applyYesScale();
  maybeEnablePulse();
}
noBtn.addEventListener("mouseover", dodgeNo);
noBtn.addEventListener("touchstart", (e) => { e.preventDefault(); dodgeNo(); }, {passive:false});

function spawnHeart(){
  const h = document.createElement("div");
  h.className = "goldHeart";
  h.textContent = "üíõ";
  h.style.left = Math.random()*100 + "vw";
  h.style.setProperty("--drift", (Math.random()*80 - 40).toFixed(0) + "px");
  h.style.animationDuration = (5.2 + Math.random()*4.2).toFixed(2) + "s";
  h.style.fontSize = (14 + Math.random()*10).toFixed(0) + "px";
  h.style.opacity = (0.55 + Math.random()*0.35).toFixed(2);
  heartsLayer.appendChild(h);
  h.addEventListener("animationend", ()=>h.remove(), { once:true });
}
function startHearts(){
  heartsLayer.style.display = "block";
  for(let i=0;i<10;i++) setTimeout(spawnHeart, i*120);
  setInterval(spawnHeart, 280);
}

function stopLoveTexts(){
  loveLayer.innerHTML = "";
  clearInterval(window.__loveTimer);
  window.__loveTimer = null;
}

function goToFinalSmooth(){
  stopLoveTexts();
  dim.classList.add("on");
  setTimeout(() => dim.classList.remove("on"), 260);

  intro.classList.add("out");
  setTimeout(() => {
    intro.style.display = "none";
    final.style.display = "block";
    requestAnimationFrame(() => final.classList.add("show"));
    setTimeout(startHearts, 250);
    // nie startujemy auto-muzyki w tej wersji ‚Äì kliknij OFF/ON
  }, 520);
}
yesBtn.addEventListener("click", goToFinalSmooth);

/* love texts */
const LOVE_PHRASES = ["kocham ciƒô üíõ","m√≥j skarb ‚ú®","z TobƒÖ zawsze üñ§","jeste≈õ moim domem üè°","tylko ty üåô","najpiƒôkniejsza ü´∂","Agol üíõ"];
function spawnLoveText(){
  if(intro.style.display === "none") return;
  const t = document.createElement("div");
  t.className = "loveText";
  t.textContent = LOVE_PHRASES[Math.floor(Math.random()*LOVE_PHRASES.length)];
  t.style.top = (Math.random()*78 + 8) + "vh";
  t.style.setProperty("--dy", (Math.random()*80 - 40).toFixed(0) + "px");
  t.style.animationDuration = (12 + Math.random()*10).toFixed(2) + "s";
  loveLayer.appendChild(t);
  t.addEventListener("animationend", () => t.remove(), { once:true });
}
window.__loveTimer = setInterval(spawnLoveText, 950);
for(let i=0;i<4;i++) setTimeout(spawnLoveText, i*650);

/* cow modal (zostawiamy ‚Äì dzia≈Ça) */
const titleAgata = document.getElementById("titleAgata");
const cowModal = document.getElementById("cowModal");
const cowCloseBtn = document.getElementById("cowCloseBtn");
let titleClicks = 0;
let titleClickTimer = null;
function openCow(){ cowModal.classList.add("on"); }
function closeCow(){ cowModal.classList.remove("on"); }
titleAgata.addEventListener("click", () => {
  titleClicks++;
  clearTimeout(titleClickTimer);
  titleClickTimer = setTimeout(() => titleClicks = 0, 900);
  if(titleClicks >= 4){ titleClicks=0; openCow(); }
});
cowCloseBtn.addEventListener("click", closeCow);
cowModal.querySelector(".cowBackdrop").addEventListener("click", closeCow);

setMusicUI(false);
</script>
</body>
</html>
